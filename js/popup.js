$(document).ready(function () {
    var bg = chrome.extension.getBackgroundPage();
    host = bg.getHost();
    console.log(host);
    $("#title_host").text(NOW_URL.hostname)
    document.getElementById("host").innerHTML = host.ip_str;
    if (host.hostnames[0]) {
        $("#domain").text(host.hostnames[0])
    } else {
        $("#domain").text("No result")
    }
    $('.ui.accordion').accordion();
    $(".cancopy").click(function () {
        copyToClipboard($(this))
    })
    $('.loadingclose')
        .on('click', function () {
            $('#loading')
                .transition('fade');
        });
    $('#neterroclose').on('click', function () {
        $('.neterror')
            .transition('fade');  

    });
    $(".neterror").hide();
});
NOW_URL = null
chrome.tabs.query({
    active: true,
    lastFocusedWindow: true
}, tabs => {
    var tab = tabs[0];
    NOW_URL = new URL(tab.url)
});

function copyToClipboard(element) {
    var $temp = $("<input>");
    $("body").append($temp);
    $temp.val(element.text()).select();
    document.execCommand("copy");
    $temp.remove();
    element.parent().append('<i class="ui green label copyed" >copied!</i>')
    setTimeout(function () {
        $('.copyed').transition('fade left')
        $(".copyed").bind("animationend webkitAnimationEnd oAnimationEnd MSAnimationEnd", function(){ $(this).remove() });

    }, 500);
}