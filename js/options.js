document.addEventListener("DOMContentLoaded", function() {

    let shodan_key = document.querySelector("#shodan_key");
    let vt_key = document.querySelector("#vt_key");
    let censys_key = document.querySelector("#censys_key");
    let censys_secret = document.querySelector("#censys_secret");
    let save_btn = document.querySelector("#option_save");

    chrome.storage.sync.get([
        "shodan_key", "vt_key",
        "censys_key", "censys_secret"
    ], function(result) {
        if(result.hasOwnProperty("shodan_key"))
            shodan_key.value = result.shodan_key;
        if(result.hasOwnProperty("vt_key"))
            vt_key.value = result.vt_key;
        if(result.hasOwnProperty("censys_key"))
            censys_key.value = result.censys_key;
        if(result.hasOwnProperty("censys_secret"))
            censys_secret.value = result.censys_secret;
    });

    save_btn.onclick = function() {
        if(shodan_key.value && vt_key.value && censys_key.value && censys_secret) {
            chrome.storage.sync.set({
                shodan_key: shodan_key.value, 
                vt_key: vt_key.value, 
                censys_key: censys_key.value, 
                censys_secret: censys_secret.value
            }, function() {
                alert("Saved");
            });
        }
        else {
            alert("尚有未輸入欄位");
        }
    }
});